<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>FKR Adoption Checklist</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <style>
    :root {
      --fkr-red: #C62828;
      --bg-light: #f2f2f2;
      --text-main: #222222;
      --card-bg: #ffffff;
      --muted: #444444;
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-light);
      color: var(--text-main);
      font-size: clamp(22px, 4vh, 32px);
    }

    .app-shell {
      width: 100%;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: var(--fkr-red);
      color: #ffffff;
      padding: 16px 12px;
      text-align: center;
    }

    header h1 {
      font-size: 1.6rem;
      margin: 0;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    header p {
      margin: 8px 0 0;
      font-size: 1.05rem;
      opacity: 0.9;
    }

    main {
      flex: 1;
      padding: 8px 10px 0;
      display: flex;
      justify-content: center;
      align-items: stretch;
    }

    .card {
      background: var(--card-bg);
      border-radius: 18px;
      padding: 22px 18px 20px;
      box-shadow: 0 3px 12px rgba(0,0,0,0.18);
      width: 100%;
      max-width: 520px;
      display: flex;
      flex-direction: column;
    }

    .step-title {
      font-size: 1.55rem;
      font-weight: 700;
      margin-bottom: 10px;
    }

    .step-subtitle {
      font-size: 1.15rem;
      color: var(--muted);
      margin-bottom: 16px;
    }

    .btn-row {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 16px;
      margin-bottom: 4px;
    }

    button {
      border-radius: 999px;
      border: none;
      padding: 18px 22px;
      font-size: 1.25rem;
      font-weight: 700;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 100%;
    }

    button.primary {
      background: var(--fkr-red);
      color: #ffffff;
    }

    button.secondary {
      background: #ffffff;
      color: var(--fkr-red);
      border: 2px solid var(--fkr-red);
    }

    button.outline {
      background: transparent;
      color: var(--muted);
      border: 1px solid rgba(0,0,0,0.35);
      font-size: 1.1rem;
      padding: 13px 18px;
    }

    button:active {
      transform: scale(0.97);
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      border-radius: 999px;
      background: #ffe4e4;
      color: var(--fkr-red);
      font-size: 1.05rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      margin-bottom: 12px;
    }

    .pill span.dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: var(--fkr-red);
    }

    .step {
      display: none;
    }

    .step.active {
      display: block;
    }

    ul.checklist {
      list-style: none;
      padding-left: 0;
      margin: 10px 0 0;
      font-size: 1.15rem;
    }

    ul.checklist li {
      margin-bottom: 9px;
      padding-left: 28px;
      position: relative;
    }

    ul.checklist li::before {
      content: "•";
      position: absolute;
      left: 9px;
      color: var(--fkr-red);
    }

    footer {
      text-align: center;
      padding: 12px 6px 14px;
      font-size: 1rem;
      color: var(--muted);
    }

    .progress {
      font-size: 1.1rem;
      color: var(--muted);
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .progress-bar-wrap {
      flex: 1;
      height: 8px;
      border-radius: 999px;
      background: #f0d4d4;
      overflow: hidden;
    }

    .progress-bar {
      height: 8px;
      width: 0%;
      background: #ffffff;
      border-radius: 999px;
      transition: width 0.25s ease-out;
    }

    .step-jump-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      gap: 8px;
      font-size: 0.95rem;
    }

    .step-jump-row button {
      padding: 10px 14px;
      font-size: 0.95rem;
      font-weight: 600;
      width: auto;
    }

    .step-jump-row select {
      flex: 1;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid #ccc;
      font-size: 0.95rem;
    }

    .help-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.55);
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
      z-index: 10;
    }

    .help-overlay.active {
      display: flex;
    }

    .help-card {
      max-width: 520px;
      width: 100%;
      background: #ffffff;
      border-radius: 14px;
      padding: 22px 20px 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.35);
      font-size: 1.15rem;
    }

    .help-title {
      font-weight: 700;
      margin-bottom: 8px;
      font-size: 1.35rem;
    }

    .help-text {
      font-size: 1.1rem;
      color: #333333;
      margin-bottom: 12px;
      white-space: normal;
    }

    .help-text p {
      margin-top: 0;
    }

    .help-text ol,
    .help-text ul {
      padding-left: 1.4em;
      margin: 0.4em 0 0.4em;
    }

    .help-close-row {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
    }

    .help-close-row button {
      font-size: 1.05rem;
      padding: 10px 20px;
      width: auto;
    }

    .help-image {
      width: 100%;
      max-width: 100%;
      border-radius: 8px;
      margin-top: 10px;
      display: block;
      cursor: pointer;
    }

    .help-detail {
      margin-top: 10px;
      padding: 10px 14px;
      font-size: 1rem;
      border-radius: 999px;
      border: 1px solid var(--fkr-red);
      background: #fff7f7;
      color: var(--fkr-red);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .help-detail:active {
      transform: scale(0.97);
    }

    /* Zoom overlay reuses help-overlay class, but card is wider */
    #image-zoom-overlay .help-card {
      max-width: 90vw;
      padding: 16px;
    }

    #zoom-image {
      width: 100%;
      max-height: 80vh;
      object-fit: contain;
      cursor: default;
    }

    @media (max-width: 380px) {
      body { font-size: clamp(20px, 4.2vh, 28px); }
      header h1 { font-size: 1.5rem; }
      .step-title { font-size: 1.5rem; }
      button { font-size: 1.2rem; }
      .step-jump-row button { font-size: 0.9rem; padding: 8px 10px; }
      .step-jump-row select { font-size: 0.9rem; }
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <h1>FKR Adoption Checklist</h1>
      <p>Tap one question at a time.</p>
    </header>

    <main>
      <div class="card">

        <div class="step-jump-row">
          <button class="outline" onclick="goTo('start', true)">Start over</button>
          <select id="step-jump" onchange="jumpToStep(this.value)">
            <option value="">Jump to step…</option>
            <option value="start">Start</option>
            <option value="prep_appointment">Appointment prep</option>
            <option value="prep_walkin">Walk in prep</option>
            <option value="meet">Meet and greet</option>
            <option value="decision">Decision</option>
            <option value="adopt_main_1">Adopter in PetPoint</option>
            <option value="adopt_main_2">Outcome started</option>
            <option value="adopt_main_3">Vouchers</option>
            <option value="adopt_main_4">Microchip consent</option>
            <option value="adopt_main_5">Folder ADA forms</option>
            <option value="adopt_main_6">Contract</option>
            <option value="adopt_main_7">Payment</option>
            <option value="adopt_after">Sending kitty home</option>
            <option value="after_leave">Adopter memo</option>
            <option value="after_memo_cat">Cat memo</option>
            <option value="after_association">Association updated</option>
            <option value="after_upload_ada">Upload ADA forms</option>
            <option value="after_upload_consult">Upload consult</option>
            <option value="after_receipt">Receipt</option>
            <option value="after_calendar">Calendar</option>
            <option value="after_photo">Photo to Kim</option>
            <option value="after_email">Outlook email</option>
            <option value="after_whiteboard">Whiteboards</option>
            <option value="no_adopt">No adoption wrap up</option>
            <option value="stop_staff">Stop and notify staff</option>
            <option value="done">Complete</option>
          </select>
        </div>

        <div class="progress">
          <div id="progress-label">Step 1</div>
          <div class="progress-bar-wrap">
            <div id="progress-bar" class="progress-bar"></div>
          </div>
        </div>

        <!-- START -->
        <div class="step active" data-step-id="start">
          <div class="pill"><span class="dot"></span><span>Start</span></div>
          <div class="step-title">What type of interaction is this?</div>
          <div class="step-subtitle">Choose one to begin.</div>
          <div class="btn-row">
            <button class="primary" onclick="setInteraction('appointment')">Scheduled appointment</button>
            <button class="secondary" onclick="setInteraction('walkin')">Walk in</button>
            <button class="outline" onclick="showHelp('start')">Show me how</button>
          </div>
        </div>

        <!-- APPOINTMENT PREP -->
        <div class="step" data-step-id="prep_appointment">
          <div class="pill"><span class="dot"></span><span>Before meet and greet</span></div>
          <div class="step-title">Appointment prep</div>
          <div class="step-subtitle">Confirm both are done.</div>
          <ul class="checklist">
            <li>Consultation form reviewed</li>
            <li>PetPoint checked for Do Not Adopt</li>
          </ul>
          <div class="btn-row">
            <button class="primary" onclick="goTo('meet')">Yes - both done</button>
            <button class="secondary" onclick="alert('Complete the items, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('prep_appointment')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- WALK IN PREP -->
        <div class="step" data-step-id="prep_walkin">
          <div class="pill"><span class="dot"></span><span>Before meet and greet</span></div>
          <div class="step-title">Walk in prep</div>
          <div class="step-subtitle">Complete these first.</div>
          <ul class="checklist">
            <li>Consultation form completed</li>
            <li>PetPoint checked for Do Not Adopt</li>
          </ul>
          <div class="btn-row">
            <button class="primary" onclick="goTo('meet')">Yes - both done</button>
            <button class="secondary" onclick="alert('Complete the items, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('prep_walkin')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- MEET AND GREET -->
        <div class="step" data-step-id="meet">
          <div class="pill"><span class="dot"></span><span>Meet and greet</span></div>
          <div class="step-title">Any concerning behavior?</div>
          <div class="step-subtitle">Watch how the adopter interacts with the cat.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('decision')">No - everything looks appropriate</button>
            <button class="secondary" onclick="goTo('stop_staff')">Yes - concern exists</button>
            <button class="outline" onclick="showHelp('meet')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- DECISION -->
        <div class="step" data-step-id="decision">
          <div class="pill"><span class="dot"></span><span>Decision</span></div>
          <div class="step-title">Did they choose a cat today?</div>
          <div class="step-subtitle">Pick Yes if a cat is going home today.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('adopt_main_1')">Yes - proceeding with adoption</button>
            <button class="secondary" onclick="goTo('no_adopt')">No - no adoption today</button>
            <button class="outline" onclick="showHelp('decision')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- ADOPTION MAIN PART 1 -->
        <div class="step" data-step-id="adopt_main_1">
          <div class="pill"><span class="dot"></span><span>Adoption</span></div>
          <div class="step-title">Is the adopter in PetPoint and is contact info verified?</div>
          <div class="step-subtitle">Confirm the person record is correct before you continue.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('adopt_main_2')">Yes - continue</button>
            <button class="secondary" onclick="alert('Make sure the person record exists and contact info is current, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('adopt_main_1')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- ADOPTION MAIN PART 2 -->
        <div class="step" data-step-id="adopt_main_2">
          <div class="pill"><span class="dot"></span><span>Adoption</span></div>
          <div class="step-title">Has Outcome to Adoption been started?</div>
          <div class="step-subtitle">The cat record should show an active Adoption outcome.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('adopt_main_3')">Yes - continue</button>
            <button class="secondary" onclick="alert('Open the cat record, start an Outcome, and choose Adoption, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('adopt_main_2')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- ADOPTION MAIN PART 3 -->
        <div class="step" data-step-id="adopt_main_3">
          <div class="pill"><span class="dot"></span><span>Adoption</span></div>
          <div class="step-title">Have vouchers been created for each cat?</div>
          <div class="step-subtitle">Each cat should have the correct voucher recorded.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('adopt_main_4')">Yes - continue</button>
            <button class="secondary" onclick="alert('Create the voucher for each cat on the adoption, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('adopt_main_3')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- ADOPTION MAIN PART 4 -->
        <div class="step" data-step-id="adopt_main_4">
          <div class="pill"><span class="dot"></span><span>Adoption</span></div>
          <div class="step-title">Is microchip consent and Petco choice completed?</div>
          <div class="step-subtitle">Make sure the adopter understands and has chosen an option.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('adopt_main_5')">Yes - continue</button>
            <button class="secondary" onclick="alert('Review microchip consent and Petco option with the adopter, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('adopt_main_4')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- ADOPTION MAIN PART 5 -->
        <div class="step" data-step-id="adopt_main_5">
          <div class="pill"><span class="dot"></span><span>Adoption</span></div>
          <div class="step-title">Have folder ADA forms been reviewed and signed?</div>
          <div class="step-subtitle">All required ADA pages in the red folder should be signed. Reminder: follow the ADA naming rules in Show me how.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('adopt_main_6')">Yes - continue</button>
            <button class="secondary" onclick="alert('Go through each ADA in the red folder, collect signatures, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('adopt_main_5')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- ADOPTION MAIN PART 6 -->
        <div class="step" data-step-id="adopt_main_6">
          <div class="pill"><span class="dot"></span><span>Adoption</span></div>
          <div class="step-title">Has the contract been signed and emailed?</div>
          <div class="step-subtitle">The adopter should have a copy of the signed contract.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('adopt_main_7')">Yes - continue</button>
            <button class="secondary" onclick="alert('Have the adopter sign the contract and email them a copy, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('adopt_main_6')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- ADOPTION MAIN PART 7 -->
        <div class="step" data-step-id="adopt_main_7">
          <div class="pill"><span class="dot"></span><span>Adoption</span></div>
          <div class="step-title">Is the payment slip completed and payment processed?</div>
          <div class="step-subtitle">Payment should be collected and recorded correctly.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('adopt_after')">Yes - continue</button>
            <button class="secondary" onclick="alert('Complete the payment slip, collect payment, and enter it in the system, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('adopt_main_7')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- ADOPTION AFTERCARE -->
        <div class="step" data-step-id="adopt_after">
          <div class="pill"><span class="dot"></span><span>Sending kitty home</span></div>
          <div class="step-title">Final checks before leaving</div>
          <ul class="checklist">
            <li>Adoption bag given</li>
            <li>Litter sample if available</li>
            <li>Kitten weight recorded</li>
            <li>Microchip verified before carrier</li>
            <li>Kennel card or photo offered for adults</li>
          </ul>
          <div class="btn-row">
            <button class="primary" onclick="goTo('after_leave')">Adopter has left</button>
            <button class="secondary" onclick="alert('Finish these items, then tap Adopter has left')">Still working</button>
            <button class="outline" onclick="showHelp('adopt_after')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- AFTER LEAVE - ADOPTER MEMO -->
        <div class="step" data-step-id="after_leave">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Has the adopter memo been completed?</div>
          <div class="step-subtitle">Add an Adoption Outcome memo on the person record.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('after_memo_cat')">Yes - continue</button>
            <button class="secondary" onclick="alert('Open the person record and add the adopter memo, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_leave')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- CAT MEMO -->
        <div class="step" data-step-id="after_memo_cat">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Has the cat outcome memo been completed?</div>
          <div class="step-subtitle">Add a short outcome memo on the pet record.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('after_association')">Yes - continue</button>
            <button class="secondary" onclick="alert('Open the pet record and add the outcome memo, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_memo_cat')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- ASSOCIATION -->
        <div class="step" data-step-id="after_association">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Has the association been updated?</div>
          <div class="step-subtitle">Change the person association to Adopter with correct subtype.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('after_upload_ada')">Yes - continue</button>
            <button class="secondary" onclick="alert('Update the association on the person record, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_association')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- UPLOAD ADA -->
        <div class="step" data-step-id="after_upload_ada">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Have ADA forms been uploaded to the cat record?</div>
          <div class="step-subtitle">Scan or upload all signed ADA pages to the animal record. Reminder: use the correct ADA file name and Type/Subtype values.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('after_upload_consult')">Yes - continue</button>
            <button class="secondary" onclick="alert('Upload the ADA forms to the cat record, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_upload_ada')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- UPLOAD CONSULT -->
        <div class="step" data-step-id="after_upload_consult">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Has the consultation form been uploaded?</div>
          <div class="step-subtitle">Upload the consult form to the person record.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('after_receipt')">Yes - continue</button>
            <button class="secondary" onclick="alert('Upload the consultation form to the person record, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_upload_consult')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- RECEIPT -->
        <div class="step" data-step-id="after_receipt">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Has the receipt been entered in PetPoint?</div>
          <div class="step-subtitle">Create and complete the receipt for the adoption.</div>
          <div class="btn-row">
            <button class="primary" onclick="goToAfterReceiptNext()">Yes - continue</button>
            <button class="secondary" onclick="alert('Enter the receipt in PetPoint and confirm totals, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_receipt')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- CALENDAR -->
        <div class="step" data-step-id="after_calendar">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Has the calendar been updated?</div>
          <div class="step-subtitle">Close or update the appointment with correct notes or outcome.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('after_photo')">Yes - continue</button>
            <button class="secondary" onclick="alert('Update the calendar entry for this appointment, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_calendar')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- PHOTO -->
        <div class="step" data-step-id="after_photo">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Has the photo been texted to Kim?</div>
          <div class="step-subtitle">Send the approved adoption photo for social media or records.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('after_email')">Yes - continue</button>
            <button class="secondary" onclick="alert('Text the photo to Kim, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_photo')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- EMAIL -->
        <div class="step" data-step-id="after_email">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Has the Outlook follow up email been sent?</div>
          <div class="step-subtitle">Send the Outlook Adoption Email: BCC Adoption Notification, subject is cat name(s), and message notes cats adopted, PP done, photo sent, and counselor names.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('after_whiteboard')">Yes - continue</button>
            <button class="secondary" onclick="alert('Send the Outlook email to the adopter, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_email')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- WHITEBOARDS -->
        <div class="step" data-step-id="after_whiteboard">
          <div class="pill"><span class="dot"></span><span>After adopter leaves</span></div>
          <div class="step-title">Have whiteboards been updated?</div>
          <div class="step-subtitle">Update any room or lobby boards that track cats and adoptions.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('done')">Yes - all wrap up tasks done</button>
            <button class="secondary" onclick="alert('Update the whiteboards and any visual trackers, then tap Yes')">Not yet</button>
            <button class="outline" onclick="showHelp('after_whiteboard')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- NO ADOPTION -->
        <div class="step" data-step-id="no_adopt">
          <div class="pill"><span class="dot"></span><span>No adoption</span></div>
          <div class="step-title">Wrap up - no adoption</div>
          <ul class="checklist">
            <li>Add Future adopt - needs discussion memo if needed</li>
            <li>If this was a walk in and they are not in PetPoint, create the person record so you can save notes and upload the consultation form</li>
            <li>Upload consultation form to person record</li>
            <li>Update calendar with correct reason</li>
          </ul>
          <div class="btn-row">
            <button class="primary" onclick="goTo('done')">All done</button>
            <button class="secondary" onclick="alert('Finish these items, then tap All done')">Still working</button>
            <button class="outline" onclick="showHelp('no_adopt')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- STOP STAFF -->
        <div class="step" data-step-id="stop_staff">
          <div class="pill"><span class="dot"></span><span>Pause</span></div>
          <div class="step-title">Stop and notify staff</div>
          <div class="step-subtitle">Step out of the room and talk to staff before continuing.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('start', true)">Situation resolved - restart</button>
            <button class="secondary" onclick="alert('Do not continue until you have spoken with staff')">Not yet</button>
            <button class="outline" onclick="showHelp('stop_staff')">Show me how</button>
            <button class="outline" onclick="goBack()">Back</button>
          </div>
        </div>

        <!-- DONE -->
        <div class="step" data-step-id="done">
          <div class="pill"><span class="dot"></span><span>Complete</span></div>
          <div class="step-title">Checklist complete</div>
          <div class="step-subtitle">You are done with this case. Tap below to start over.</div>
          <div class="btn-row">
            <button class="primary" onclick="goTo('start', true)">Start again</button>
            <button class="outline" onclick="showHelp('done')">Show me how</button>
          </div>
        </div>

      </div>
    </main>

    <footer>
      FKR - no data stored
    </footer>
  </div>

  <!-- Help overlay -->
  <div id="help-overlay" class="help-overlay" aria-hidden="true">
    <div class="help-card" id="help-card">
      <div class="help-title" id="help-title">Step help</div>
      <div class="help-text" id="help-text">Details for this step will appear here.</div>
      <div class="help-close-row">
        <button class="outline" id="help-back-btn" style="display:none;" onclick="backToMainHelp()">Back</button>
        <button class="outline" onclick="hideHelp()">Close</button>
      </div>
    </div>
  </div>

  <!-- Image zoom overlay -->
  <div id="image-zoom-overlay" class="help-overlay" aria-hidden="true">
    <div class="help-card">
      <div class="help-title" id="zoom-title">Zoom</div>
      <img id="zoom-image" src="" alt="Zoomed help" />
      <div class="help-close-row">
        <button class="outline" onclick="hideZoom()">Close</button>
      </div>
    </div>
  </div>

  <script>
    const historyStack = ['start'];
    const steps = Array.from(document.querySelectorAll('.step'));
    const progressLabel = document.getElementById('progress-label');
    const progressBar = document.getElementById('progress-bar');

    const orderedStepIds = [
      'start',
      'prep_appointment',
      'prep_walkin',
      'meet',
      'decision',
      'adopt_main_1',
      'adopt_main_2',
      'adopt_main_3',
      'adopt_main_4',
      'adopt_main_5',
      'adopt_main_6',
      'adopt_main_7',
      'adopt_after',
      'after_leave',
      'after_memo_cat',
      'after_association',
      'after_upload_ada',
      'after_upload_consult',
      'after_receipt',
      'after_calendar',
      'after_photo',
      'after_email',
      'after_whiteboard',
      'no_adopt',
      'stop_staff',
      'done'
    ];

    let interactionType = null;

    function setInteraction(type) {
      interactionType = type;
      if (type === 'appointment') {
        goTo('prep_appointment');
      } else {
        goTo('prep_walkin');
      }
    }

    function goToAfterReceiptNext() {
      if (interactionType === 'walkin') {
        goTo('after_photo');
      } else {
        goTo('after_calendar');
      }
    }

    function jumpToStep(id) {
      if (!id) return;
      goTo(id);
      const select = document.getElementById('step-jump');
      select.value = '';
    }

    const helpContent = {
      start:
        "Choose <strong>Scheduled appointment</strong> if this person was on the calendar.<br><br>" +
        "Choose <strong>Walk in</strong> if they arrived without a scheduled time.",

      prep_appointment:
        "<p><strong>For a scheduled appointment:</strong></p>" +
        "<ol>" +
        "<li>Open the consultation form and review it before the meet and greet.</li>" +
        "<li>In PetPoint, search for the person and check for any Do Not Adopt flags.</li>" +
        "<li>If you see anything concerning, pause and talk with staff before you continue.</li>" +
        "</ol>",

      prep_walkin:
        "<p><strong>For a walk in:</strong></p>" +
        "<ol>" +
        "<li>Have the visitor complete the consultation form.</li>" +
        "<li>Check that all required questions are answered.</li>" +
        "<li>In PetPoint, search for the person or create a new record.</li>" +
        "<li>Confirm they are not on the Do Not Adopt list before starting a meet and greet.</li>" +
        "</ol>",

      meet:
        "<p>During the meet and greet:</p>" +
        "<ul>" +
        "<li>Watch how the person handles and talks about the cat.</li>" +
        "<li>Listen for plans that sound unsafe or do not match FKR policies.</li>" +
        "<li>If you feel uneasy or unsure, treat it as a concern and pause to talk with staff.</li>" +
        "</ul>",

      decision:
        "<p>If they clearly chose a specific cat today, pick <strong>Yes</strong> and move into the adoption steps.</p>" +
        "<p>If they are still thinking, left without choosing, or want to come back another day, pick <strong>No</strong>.</p>",

      adopt_main_1:
        "<p><strong>PetPoint person record:</strong></p>" +
        "<ol>" +
        "<li>Search by name, email, or phone.</li>" +
        "<li>If a record exists, confirm address, phone, and email.</li>" +
        "<li>If needed, create a new record with complete contact info.</li>" +
        "<li>Check that there are no duplicate records for this person.</li>" +
        "</ol>",

      adopt_main_2:
        "<p><strong>Starting the adoption outcome:</strong></p>" +
        "<ol>" +
        "<li>Open the <strong>Person</strong> record for the adopter.</li>" +
        "<li>Use the green plus menu to add a new <strong>Outcome</strong>.</li>" +
        "<li>Choose <strong>Adoption</strong> and confirm you are on the correct person.</li>" +
        "<li>Link the correct cat and check that Type, Subtype, and Status are correct.</li>" +
        "</ol>" +
        "<button class='help-detail' data-subhelp='adopt_outcome_start'>Show where to start Outcome</button>" +
        "<button class='help-detail' data-subhelp='adopt_outcome_fields'>Show Outcome fields example</button>",

      adopt_main_3:
        "<p><strong>Vouchers:</strong></p>" +
        "<ol>" +
        "<li>Confirm which voucher each cat should receive.</li>" +
        "<li>On the cat record, create the voucher and link it to the adoption.</li>" +
        "<li>Check that Type, Subtype, and Issued/Expiry dates are correct.</li>" +
        "</ol>" +
        "<button class='help-detail' data-subhelp='voucher_cat'>Show voucher example</button>",

      adopt_main_4:
        "<p><strong>Microchip and wellness option:</strong></p>" +
        "<ol>" +
        "<li>Confirm the microchip number is in the cat record.</li>" +
        "<li>Explain how registration works and why it matters.</li>" +
        "<li>Review the Petco or other wellness option and let the adopter choose.</li>" +
        "<li>Record their choice and consent where required.</li>" +
        "</ol>",

      adopt_main_5:
        "<p><strong>Folder ADA forms:</strong></p>" +
        "<ol>" +
        "<li>Pull the correct red folder for this cat or group of cats.</li>" +
        "<li>Go through each ADA and explain any special notes or restrictions.</li>" +
        "<li>Answer questions and confirm understanding.</li>" +
        "<li>Have the adopter sign where required and check that every required signature is present.</li>" +
        "</ol>",

      adopt_main_6:
        "<p><strong>Contract:</strong></p>" +
        "<ol>" +
        "<li>From the completed adoption outcome, open the contract print option.</li>" +
        "<li>Print or display the contract for the adopter to sign.</li>" +
        "<li>Follow your normal workflow for emailing the signed copy to the adopter.</li>" +
        "</ol>" +
        "<button class='help-detail' data-subhelp='contract_print'>Show where to print contract</button>",

      adopt_main_7:
        "<p><strong>Payment:</strong></p>" +
        "<ol>" +
        "<li>Fill out the payment slip with correct fees and discounts.</li>" +
        "<li>Take payment using the approved method.</li>" +
        "<li>Record payment in PetPoint under the correct adopter.</li>" +
        "<li>Confirm the balance shows as paid.</li>" +
        "</ol>",

      adopt_after:
        "<p><strong>Before they leave:</strong></p>" +
        "<ul>" +
        "<li>Put together the adoption bag.</li>" +
        "<li>Add litter sample if you have it.</li>" +
        "<li>Record kitten weight where needed.</li>" +
        "<li>Scan the cat to confirm microchip.</li>" +
        "<li>Offer the kennel card or printed photo if that is standard.</li>" +
        "</ul>",

      after_leave:
        "<p><strong>Adopter memo on person:</strong></p>" +
        "<ol>" +
        "<li>Open the <strong>Person</strong> record for the adopter.</li>" +
        "<li>Add a new memo with Type <strong>Adoption Outcome</strong> and Subtype <strong>Adopted</strong>.</li>" +
        "<li>Note any key facts about the appointment that will help if they call later.</li>" +
        "</ol>" +
        "<button class='help-detail' data-subhelp='adopter_memo'>Show adopter memo example</button>",

      after_memo_cat:
        "<p><strong>Cat outcome memo:</strong></p>" +
        "<ol>" +
        "<li>Open the cat's record.</li>" +
        "<li>Add a new memo with Type <strong>Outcome</strong> and Subtype <strong>Adoption</strong>.</li>" +
        "<li>Add a short note such as where the cat went and if they will join other pets.</li>" +
        "</ol>" +
        "<button class='help-detail' data-subhelp='cat_memo'>Show cat memo example</button>",

      after_association:
        "<p><strong>Update association:</strong></p>" +
        "<ol>" +
        "<li>On the person record, open the Associations tab.</li>" +
        "<li>Add a new association for <strong>Adopter</strong>.</li>" +
        "<li>Use the same Subtype that was on their Potential Adopter association (for example, FKR Website).</li>" +
        "</ol>" +
        "<button class='help-detail' data-subhelp='association_new'>Show association example</button>",

      after_upload_ada:
        "<p><strong>Upload ADA forms and use correct naming:</strong></p>" +
        "<ol>" +
        "<li>Scan or photograph the signed ADA pages.</li>" +
        "<li>On the cat record, go to <strong>Memos/Files</strong> and click the green plus next to Files.</li>" +
        "<li>For the file <strong>Name</strong>, use <strong>Signed Kitten ADA -kitty name</strong> and/or <strong>Signed Medical ADA -kitty name</strong> as appropriate.</li>" +
        "<li>Set <strong>Type</strong> to <em>Adoption Document</em> and <strong>Subtype</strong> to <em>Adoption Disclosure Agreement - ADA</em>.</li>" +
        "<li>Select the scanned file from Downloads and upload it. Confirm you can clearly read dates and signatures.</li>" +
        "</ol>",

      after_upload_consult:
        "<p><strong>Upload consultation form:</strong></p>" +
        "<ol>" +
        "<li>Scan or photograph the consult form.</li>" +
        "<li>On the person record, upload the file to their documents or memos/files area.</li>" +
        "<li>Make sure the date and notes are visible.</li>" +
        "</ol>",

      after_receipt:
        "<p><strong>Enter the receipt:</strong></p>" +
        "<ol>" +
        "<li>From the person record, use the green plus menu to create a new <strong>Receipt</strong>.</li>" +
        "<li>On the Receipt - New screen, set the cash drawer and reference as your group uses them.</li>" +
        "<li>Add the adoption item based on age and link the correct cat.</li>" +
        "<li>When you click Pay, fill out the payment panel. Select Cash as the type if that is your standard, even when using Square, and note card details in the reference.</li>" +
        "</ol>" +
        "<button class='help-detail' data-subhelp='receipt_new'>How to create new receipt</button>" +
        "<button class='help-detail' data-subhelp='receipt_screen'>Receipt - New screen example</button>",

      after_calendar:
        "<p><strong>Update the calendar:</strong></p>" +
        "<ol>" +
        "<li>Open the original appointment on the calendar.</li>" +
        "<li>Mark it as completed and note that the cat was adopted.</li>" +
        "<li>Use your standard wording for no-show, reschedule, or completed adoption.</li>" +
        "</ol>",

      after_photo:
        "<p><strong>Photo to Kim:</strong></p>" +
        "<ol>" +
        "<li>Choose a clear photo of adopter and cat.</li>" +
        "<li>Text the photo to Kim using the rescue's standard number or thread.</li>" +
        "<li>Confirm guidelines about faces, minors, and social media have been followed.</li>" +
        "</ol>",

      after_email:
        "<p><strong>Outlook Adoption Email:</strong></p>" +
        "<ol>" +
        "<li>Open Outlook and click <em>New Message</em>.</li>" +
        "<li>In <strong>BCC</strong>, enter <em>Adoption Notification</em>. Leave the To and CC lines blank.</li>" +
        "<li>Subject line: type the name(s) of the cat(s) adopted.</li>" +
        "<li>In the message body, list the cat name(s), note that <em>PP done</em>, and indicate if the photo was sent.</li>" +
        "<li>At the end of the message, include the names of the adoption counselors working that day.</li>" +
        "</ol>",

      after_whiteboard:
        "<p><strong>Whiteboards:</strong></p>" +
        "<ol>" +
        "<li>Update any room or lobby boards that track which cats are available or adopted.</li>" +
        "<li>Erase the adopted cat from available lists.</li>" +
        "<li>Add any new notes that are part of your standard process.</li>" +
        "</ol>",

      no_adopt:
        "<p><strong>If no cat was adopted:</strong></p>" +
        "<ol>" +
        "<li>If something felt concerning or needs more review, add a <em>Future adopt - needs discussion</em> memo.</li>" +
        "<li>If this was a walk in and there is no PetPoint person record yet, first search to be sure they are not already in the system, then <strong>create the person</strong> with full contact info.</li>" +
        "<li>Scan and upload the consultation form to the person record so it is saved even if they did not adopt.</li>" +
        "<li>Update the calendar with the correct no adoption reason.</li>" +
        "</ol>" +
        "<button class='help-detail' data-subhelp='person_create'>Show how to create person</button>",

      stop_staff:
        "<p><strong>When you have a concern:</strong></p>" +
        "<ol>" +
        "<li>End the visit kindly and step out of the room.</li>" +
        "<li>Find a staff member and explain what you saw or heard.</li>" +
        "<li>Follow staff direction before you schedule or approve anything else with this adopter.</li>" +
        "</ol>",

      done:
        "<p>This means you have finished all required tasks for this case.</p>" +
        "<p>You can tap <strong>Start again</strong> when you are ready to begin the checklist for the next adopter.</p>"
    };

    const subHelpContent = {
      adopt_outcome_start: {
        title: "Where to start Outcome on person",
        html:
          "<img src='images/1-create-new-outcome-on-person.png' alt='Add Outcome from green plus menu on person' class='help-image'>"
      },
      adopt_outcome_fields: {
        title: "Outcome - New fields example",
        html:
          "<img src='images/2-outcome-form-filled.png' alt='Outcome New form filled example' class='help-image'>"
      },
      voucher_cat: {
        title: "Voucher on cat example",
        html:
          "<img src='images/3-voucher-on-cat.png' alt='Voucher Automatic screen on cat' class='help-image'>"
      },
      contract_print: {
        title: "Where to print contract",
        html:
          "<img src='images/4-create-contract-on-person-outcome.png' alt='Contract print option on adoption outcome' class='help-image'>"
      },
      adopter_memo: {
        title: "Adopter memo on person",
        html:
          "<img src='images/5-Adopter-memo.png' alt='Adoption Outcome memo on person' class='help-image'>"
      },
      cat_memo: {
        title: "Cat outcome memo",
        html:
          "<img src='images/7-memo-on-pet.png' alt='Outcome memo on pet' class='help-image'>"
      },
      association_new: {
        title: "Association - new example",
        html:
          "<img src='images/6-Association.png' alt='Association New screen with instructions' class='help-image'>"
      },
      receipt_new: {
        title: "How to create new receipt",
        html:
          "<img src='images/8-new-receipt-on-person.png' alt='New receipt from person record' class='help-image'>"
      },
      receipt_screen: {
        title: "Receipt - New screen example",
        html:
          "<img src='images/9-receipt-form.png' alt='Receipt form and payment panel' class='help-image'>"
      },
      person_create: {
        title: "How to create a new person",
        html:
          "<ol>" +
          "<li>From the main People search in PetPoint, search by name, email, and phone to confirm they are not already in the system.</li>" +
          "<li>If no match appears, click <strong>New Person</strong>.</li>" +
          "<li>Enter their full name, address, phone, and email. Fill any required fields your rescue uses.</li>" +
          "<li>Click <strong>Save</strong>. You can now upload the consultation form and add memos to this person record even if they did not adopt today.</li>" +
          "</ol>"
      }
    };

    let currentHelpStep = null;

    function showStep(id) {
      steps.forEach(step => {
        step.classList.toggle('active', step.dataset.stepId === id);
      });
      const index = orderedStepIds.indexOf(id);
      if (index >= 0) {
        const stepNum = index + 1;
        const total = orderedStepIds.length;
        progressLabel.textContent = "Step " + stepNum + " of " + total;
        const pct = Math.round((stepNum - 1) / (total - 1) * 100);
        progressBar.style.width = pct + "%";
      } else {
        progressBar.style.width = "0%";
      }
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    function goTo(id, reset = false) {
      if (reset) {
        historyStack.length = 0;
        historyStack.push(id);
      } else {
        const last = historyStack[historyStack.length - 1];
        if (last !== id) {
          historyStack.push(id);
        }
      }
      showStep(id);
    }

    function goBack() {
      if (historyStack.length > 1) {
        historyStack.pop();
        showStep(historyStack[historyStack.length - 1]);
      } else {
        showStep("start");
      }
    }

    function showHelp(stepId) {
      currentHelpStep = stepId;
      const overlay = document.getElementById("help-overlay");
      const titleEl = document.getElementById("help-title");
      const textEl = document.getElementById("help-text");
      const backBtn = document.getElementById("help-back-btn");

      const defaultTitle = "Step help";
      const defaultText = "If you are unsure what to do on this step, pause and ask a staff member for guidance.";

      let title = defaultTitle;
      let text = helpContent[stepId] || defaultText;

      const stepEl = document.querySelector('.step[data-step-id="' + stepId + '"] .step-title');
      if (stepEl) {
        title = stepEl.textContent;
      }

      titleEl.textContent = title;
      textEl.innerHTML = text;

      backBtn.style.display = "none";
      overlay.classList.add("active");
      overlay.setAttribute("aria-hidden", "false");
    }

    function showSubHelp(subId) {
      const overlay = document.getElementById("help-overlay");
      const titleEl = document.getElementById("help-title");
      const textEl = document.getElementById("help-text");
      const backBtn = document.getElementById("help-back-btn");

      const data = subHelpContent[subId];
      if (!data) return;

      titleEl.textContent = data.title || "More details";
      textEl.innerHTML = data.html || "";
      backBtn.style.display = currentHelpStep ? "inline-flex" : "none";

      overlay.classList.add("active");
      overlay.setAttribute("aria-hidden", "false");
    }

    function backToMainHelp() {
      if (currentHelpStep) {
        showHelp(currentHelpStep);
      }
    }

    function hideHelp() {
      const overlay = document.getElementById("help-overlay");
      overlay.classList.remove("active");
      overlay.setAttribute("aria-hidden", "true");
    }

    // zoom overlay helpers
    function showZoom(imgEl) {
      const zoomOverlay = document.getElementById("image-zoom-overlay");
      const zoomImage = document.getElementById("zoom-image");
      const zoomTitle = document.getElementById("zoom-title");

      zoomImage.src = imgEl.src;
      zoomImage.alt = imgEl.alt || "Zoomed help";
      zoomTitle.textContent = imgEl.alt || "Zoom";

      zoomOverlay.classList.add("active");
      zoomOverlay.setAttribute("aria-hidden", "false");
    }

    function hideZoom() {
      const zoomOverlay = document.getElementById("image-zoom-overlay");
      const zoomImage = document.getElementById("zoom-image");
      zoomOverlay.classList.remove("active");
      zoomOverlay.setAttribute("aria-hidden", "true");
      zoomImage.src = "";
    }

    // watch for clicks on detail buttons inside the help card
    document.getElementById("help-card").addEventListener("click", function (e) {
      const btn = e.target.closest("[data-subhelp]");
      if (btn) {
        const subId = btn.getAttribute("data-subhelp");
        showSubHelp(subId);
        return;
      }

      const img = e.target.closest(".help-image");
      if (img) {
        showZoom(img);
      }
    });

    // also allow clicking the zoomed image background to close
    document.getElementById("image-zoom-overlay").addEventListener("click", function (e) {
      if (e.target.id === "image-zoom-overlay") {
        hideZoom();
      }
    });

    // initial render
    showStep("start");
  </script>
</body>
</html>